ben <- iris
View(ben)
rm(list = ls())
getwd()
setwd("~/Echo Case Study")
rm(list = ls())
install.packages("readr")
install.packages("tidyverse")
?read.csv2
?read.csv2
ben <- read.csv2("212JourneyDataExtract29Apr2020-05May2020.csv", header = TRUE sep = ",")
ben <- read.csv2("212JourneyDataExtract29Apr2020-05May2020.csv", header = TRUE ,sep = ",")
View(ben)
install.packages("dplyr")
library(dplyr)
library(dplyr)
library("dplyr")
library("dplyr")
library(tidyverse)
install.packages("dplyr")
install.packages("readr")
library(dplyr)
install.packages("purrr")
install.packages("dplyr")
library(dplyr)
library(readr)
journeys_data <- read.csv2("All_journeys_29thApr-26thMay.csv", header = TRUE ,sep = ",")
all_stations <- read.csv2("All_stations.csv", header = TRUE ,sep = ",")
?left_join
ben <- all_stations
View(ben)
names(journeys_data)
names(journeys_data) <- c("rental_id", "duration", "bike_id", "end_date", "end_station_id", "end_station_name", "start_date", "start_station_id", "start_station_name")
names(journeys_data)
View(journeys_data)
journey_start <- journeys_data %>% group_by(start_station_id) %>% summarise(num_start_journeys = n_distinct(journeys_data$rental_id))
journey_end <- journeys_data %>% group_by(end_station_id) %>% summarise(num_end_journeys = n_distinct(journeys_data$rental_id))
View(journey_start)
View(journey_end)
View(journey_start)
journey_start <- journeys_data %>% group_by(start_station_id) %>% summarise(num_start_journeys = n_distinct(rental_id))
View(journey_start)
View(journey_end)
journey_end <- journeys_data %>% group_by(end_station_id) %>% summarise(num_end_journeys = n_distinct(rental_id))
View(journey_end)
ben <- all_stations %>% left_join(journey_start, by = c("id" = "start_station_id"))
View(ben)
ben <- all_stations %>% left_join(journey_start, by = c("id" = "start_station_id")) %>% left_join(journey_end, by = c("id" = "end_station_id"))
View(ben)
total_touchpoints <- all_stations %>% left_join(journey_start, by = c("id" = "start_station_id")) %>% left_join(journey_end, by = c("id" = "end_station_id"))
write.csv(total_touchpoints, "total_cycle_touchpoints.csv")
View(journeys_data)
ben <- journeys_data %>% filter(end_station_id = 191)
ben <- journeys_data %>% filter(end_station_id == 191)
ben <- journeys_data %>% filter(start_station_id == 191)
View(total_touchpoints)
rm(total_touchpoints)
#join the data tables
total_touchpoints_data <- all_stations %>% left_join(journey_start, by = c("id" = "start_station_id")) %>% left_join(journey_end, by = c("id" = "end_station_id"))
total_touchpoints_data <- total_touchpoints_data %>% mutate(total_touchpoints = num_start_journeys + num_end_journeys) %>% mutate(avg_weekly_touchpoints = total_touchpoints/4)
View(total_touchpoints_data)
total_touchpoints_data <- total_touchpoints_data %>% mutate(total_touchpoints = num_start_journeys + num_end_journeys) %>% mutate(avg_weekly_touchpoints = total_touchpoints/4)
write.csv(total_touchpoints, "total_cycle_touchpoints.csv")
write.csv(total_touchpoints_data, "total_cycle_touchpoints.csv")
View(total_touchpoints_data)
week_dock_table <- 1:1:166
week_dock_table <- data.frame(1:1:166)
View(week_dock_table)
?data_frame
View(week_dock_table)
?rename
names(week_dock_table)
week_dock_table <- data.frame(1:1:166) %>% rename(num_stations = week_dock_table$X1.1.166)
names(week_dock_table)
week_dock_table <- data.frame(1:1:166) %>% rename(num_stations = X1.1.166)
names(week_dock_table)
week_dock_table <- data.frame(1:1:166) %>% rename(num_stations = X1.1.166)
?floor
week_dock_table <- data.frame(1:1:166) %>%
rename(num_stations_r = X1.1.166) %>%
mutate(num_weeks = floor(((50000/E15) -100)/200))
week_dock_table <- data.frame(1:1:166) %>%
rename(num_stations_r = X1.1.166) %>%
mutate(num_weeks = floor(((50000/num_stations_r) -100)/200))
View(week_dock_table)
week_dock_table <- data.frame(1:1:166) %>%
rename(num_stations_r = X1.1.166) %>%
mutate(num_weeks = floor(((50000/num_stations_r) -100)/200)) %>%
group_by(num_weeks) %>%
summarise(num_stations = max(num_stations_r))
View(week_dock_table)
week_dock_table <- data.frame(1:1:166) %>%
rename(num_stations_r = X1.1.166) %>%
mutate(num_weeks = floor(((50000/num_stations_r) -100)/200)) %>%
group_by(num_weeks) %>%
summarise(num_stations = max(num_stations_r)) %>%
mutate(campaign_cost = num_stations*((200*num_weeks) + 100))
View(week_dock_table)
?plot
plot(num_stations, num_weeks)
plot(week_dock_table$num_weeks, week_dock_table$num_stations)
plot(week_dock_table$num_stations, week_dock_table$num_weeks)
View(total_touchpoints_data)
rm(list = ls())
##Install libraries
library(dplyr)
library(readr)
##Read data
journeys_data <- read.csv2("All_journeys_29thApr-26thMay.csv", header = TRUE ,sep = ",")
names(journeys_data) <- c("rental_id", "duration", "bike_id", "end_date", "end_station_id", "end_station_name", "start_date", "start_station_id", "start_station_name")
all_stations <- read.csv2("All_stations.csv", header = TRUE ,sep = ",")
##data manipulation
#calculate number of journeys at starting point
journey_start <- journeys_data %>% group_by(start_station_id) %>% summarise(num_start_journeys = n_distinct(rental_id))
#calculate number of journeys at ending point
journey_end <- journeys_data %>% group_by(end_station_id) %>% summarise(num_end_journeys = n_distinct(rental_id))
#join the data tables
total_touchpoints_data <- all_stations %>% left_join(journey_start, by = c("id" = "start_station_id")) %>% left_join(journey_end, by = c("id" = "end_station_id"))
# Add total Touchpoints and touch points per week
total_touchpoints_data <- total_touchpoints_data %>% mutate(total_touchpoints = num_start_journeys + num_end_journeys) %>% mutate(avg_weekly_touchpoints = total_touchpoints/4)
##Analysis
conv_rate <- 0.25
week_dock_table <- data.frame(1:166) %>%
rename(num_stations_r = X1.1.166) %>%
mutate(num_weeks = floor(((50000/num_stations_r) -100)/200)) %>%
group_by(num_weeks) %>%
summarise(num_stations = max(num_stations_r)) %>%
mutate(campaign_cost = num_stations*((200*num_weeks) + 100))
#plot(week_dock_table$num_stations, week_dock_table$num_weeks)
#Output
write.csv(total_touchpoints_data, "total_cycle_touchpoints.csv")
#testing
ben <- journeys_data %>% filter(start_station_id == 191)
total_touchpoints_data <- total_touchpoints_data %>% mutate(total_touchpoints = num_start_journeys + num_end_journeys) %>% mutate(weekly_touchpoints = total_touchpoints/4)
conv_rate <- 0.25
week_dock_table <- data.frame(1:166) %>%
rename(num_stations_r = X1.1.166) %>%
mutate(num_weeks = floor(((50000/num_stations_r) -100)/200)) %>%
group_by(num_weeks) %>%
summarise(num_stations = max(num_stations_r)) %>%
mutate(campaign_cost = num_stations*((200*num_weeks) + 100))
write.csv(total_touchpoints_data, "total_cycle_touchpoints.csv")
ben <- total_touchpoints_data %>% arrange(desc(weekly_touchpoints))
View(ben)
names(all_stations)
?select
all_stations <- all_stations %>% select(id, latitude, longitude, name)
journey_start <- journeys_data %>% group_by(start_station_id) %>% summarise(num_start_journeys = n_distinct(rental_id))
journey_end <- journeys_data %>% group_by(end_station_id) %>% summarise(num_end_journeys = n_distinct(rental_id))
#join the data tables
total_touchpoints_data <- all_stations %>% left_join(journey_start, by = c("id" = "start_station_id")) %>% left_join(journey_end, by = c("id" = "end_station_id"))
total_touchpoints_data <- total_touchpoints_data %>% mutate(total_touchpoints = num_start_journeys + num_end_journeys) %>% mutate(weekly_touchpoints = total_touchpoints/4)
conv_rate <- 0.25
week_dock_table <- data.frame(1:166) %>%
rename(num_stations_r = X1.1.166) %>%
mutate(num_weeks = floor(((50000/num_stations_r) -100)/200)) %>%
group_by(num_weeks) %>%
summarise(num_stations = max(num_stations_r)) %>%
mutate(campaign_cost = num_stations*((200*num_weeks) + 100))
dock_parameter <- 45
week_dock_table <- data.frame(1:166) %>%
rename(num_stations_r = X1.1.166) %>%
mutate(num_weeks = floor(((50000/num_stations_r) -100)/200)) %>%
group_by(num_weeks) %>%
summarise(num_stations = max(num_stations_r)) %>%
mutate(campaign_cost = num_stations*((200*num_weeks) + 100))
View(total_touchpoints_data)
week_dock_table <- data.frame(1:166) %>%
week_dock_table <- data.frame(1:166)
week_dock_table <- data.frame(1:166)
View(week_dock_table)
week_dock_table <- data.frame(1:166) %>%
rename(num_stations_r = X1.1.166)
week_dock_table <- data.frame(1:166) %>%
rename(num_stations_r = X1.166)
week_dock_table <- data.frame(1:166) %>%
rename(num_stations_r = X1.166) %>%
mutate(num_weeks = floor(((50000/num_stations_r) -100)/200)) %>%
group_by(num_weeks) %>%
summarise(num_stations = max(num_stations_r)) %>%
mutate(campaign_cost = num_stations*((200*num_weeks) + 100))
dock_parameter <- 45
ben <- total_touchpoints_data %>% arrange(desc(weekly_touchpoints))
rows
?rows
ben[3]
ben[3,]
ben[1:3,]
ben[1:1,]
sum(ben[1:1,]$weekly_touchpoints)
sum(ben[1:2,]$weekly_touchpoints)
sum(ben[1:3,]$weekly_touchpoints)
kim <- week_dock_table %>% mutate(weekly_touches = sum(ben[1:num_stations,]$weekly_touchpoints)
kim <- week_dock_table %>% mutate(weekly_touches = sum(ben[1:num_stations,]$weekly_touchpoints))
1:num_stations
1:week_dock_table$num_stations
kim <- week_dock_table %>% mutate(weekly_touches = sum(ben[1:num_stations,]$weekly_touchpoints))
View(week_dock_table)
View(kim)
kim <- week_dock_table %>%
mutate(weekly_touches = sum(top_n(ben, num_stations, weekly_touches)))
kim <- week_dock_table %>%
mutate(weekly_touches = sum(top_n(ben, num_stations, ben$weekly_touches)))
View(kim)
View(ben)
ben <- total_touchpoints_data %>% arrange(desc(weekly_touchpoints)) %>% mutate(cumsum(weekly_touchpoints))
ben <- total_touchpoints_data %>% arrange(desc(weekly_touchpoints)) %>% mutate(sum_weekly_touchpoints = cumsum(weekly_touchpoints))
ben <- total_touchpoints_data %>% arrange(desc(weekly_touchpoints)) %>%
mutate(sum_weekly_touchpoints = cumsum(weekly_touchpoints)) %>% select(sum_weekly_touchpoints)
kim <- week_dock_table
View(kim)
ben <- total_touchpoints_data %>% arrange(desc(weekly_touchpoints)) %>%
mutate(sum_weekly_touchpoints = cumsum(weekly_touchpoints))
View(ben)
ben <- total_touchpoints_data %>% arrange(desc(weekly_touchpoints)) %>%
mutate(rn = row_number(), sum_weekly_touchpoints = cumsum(weekly_touchpoints)) %>% select(sum_weekly_touchpoints)
View(ben)
View(ben)
ben <- total_touchpoints_data %>% arrange(desc(weekly_touchpoints)) %>%
mutate(rn = row_number(), sum_weekly_touchpoints = cumsum(weekly_touchpoints)) %>% select(rn, sum_weekly_touchpoints)
View(ben)
ben <- total_touchpoints_data %>% arrange(desc(weekly_touchpoints)) %>%
mutate(rn = row_number(), sum_weekly_touchpoints = cumsum(weekly_touchpoints))
ben <- total_touchpoints_data %>% arrange(desc(weekly_touchpoints)) %>%
mutate(rn = row_number(), sum_weekly_touchpoints = cumsum(weekly_touchpoints)) %>% select(rn, sum_weekly_touchpoints)
kim <- week_dock_table %>% left_join(agg_touchpoints, by = c("num_stations"="rn"))
agg_touchpoints <- total_touchpoints_data %>% arrange(desc(weekly_touchpoints)) %>%
mutate(rn = row_number(), sum_weekly_touchpoints = cumsum(weekly_touchpoints)) %>% select(rn, sum_weekly_touchpoints)
kim <- week_dock_table %>% left_join(agg_touchpoints, by = c("num_stations"="rn"))
View(kim)
View(agg_touchpoints)
kim <- week_dock_table %>% left_join(agg_touchpoints, by = c("num_stations"="rn")) %>% mutate(total_touches = num_weeks*sum_weekly_touchpoints)
week_dock_touches <- week_dock_table %>% left_join(agg_touchpoints, by = c("num_stations"="rn")) %>% mutate(total_touches = num_weeks*sum_weekly_touchpoints)
plot(num_stations, total_touches)
plot(num_stations, total_touches)
plot(week_dock_touches$num_stations, week_dock_touches$total_touches)
